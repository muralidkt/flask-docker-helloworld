
name: "Code Scanning - Action"

on: [push]

jobs:
  CodeQL-Build:
    runs-on: ubuntu-latest

    permissions:
      security-events: write
      actions: read
      contents: read

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2


      - name: Initialize CodeQL
        uses: github/codeql-action/init@v1
        # Override language selection by uncommenting this and choosing your languages
        with:
          languages: python

      - name: Perform CodeQL Analysis
        uses: github/codeql-action/analyze@v1
      - name: list
        run: |
          ls -ltr
          pwd
          cat /home/runner/work/flask-docker-helloworld/results/python.sarif

      - name: Downaload the scripts
        run: |
          curl -sL -O https://raw.githubusercontent.com/muralidkt/defectdojo-client/main/test/defectdojo_apiv2.py
          curl -sL -O https://raw.githubusercontent.com/muralidkt/defectdojo-client/main/test/defectdojo.py
        
      - name: Upload the result
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'
      - run: pip install requests
      - run: python3 defectdojo.py --host https://defectdojo.shellctl.com --api_token 1ade1e0980c87b2cf8aa44e8ab5031c6622123c7 --engagement 19 --user admin --product_name producti-1 --file /home/runner/work/flask-docker-helloworld/results/python.sarif --scanner "SARIF"
   
      